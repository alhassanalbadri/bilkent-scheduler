name: Scrape Latest Semester

on:
  schedule:
    - cron: 0 0 1 * 0
    - cron: 0 0 16 * *

  workflow_dispatch:
    inputs:
      logLevel:
        description: "Reason"
        required: true
        default: "warning"

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Check out the repo
        uses: actions/checkout@master
      - name: Add Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
      - name: Scrape Semester
        run: |
          pip install requests beautifulsoup4
          python ./scrapers/fetch-semesters.py
      - name: Get Time
        id: time
        uses: nanzm/get-time-action@v1.1
        with:
          format: "DD-MM-YYYY"
      - name: Commit Back Changed Data
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "Latest Semester data: ${{ steps.time.outputs.time }}"
          commit_author: Author <actions@github.com>
          file_pattern: data/*.json
